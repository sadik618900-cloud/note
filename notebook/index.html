<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>নোট প্যাড - আপনার ডিজিটাল ডায়েরি</title>
    
    <!-- Noto Sans Bengali à¦«à¦¨à§à¦Ÿ à¦²à¦¿à¦‚à¦• -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700;800&family=Hind+Siliguri:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
        <link rel="stylesheet" href="./app-redesign.css">
</head>
<body data-theme="light">
    <div class="app-wrap">
        <header class="site-header">
            <div class="header-main">
                <div class="logo">
                    <i class="fas fa-book-open"></i>
                    <div class="logo-text">
                        <span class="logo-title">নোট প্যাড</span>
                        <small class="logo-subtitle">আপনার স্মার্ট ডিজিটাল নোটবুক</small>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="export-btn" id="exportAllBtn" title="সব নোট ব্যাকআপ করুন">
                        <i class="fas fa-download"></i>
                        ব্যাকআপ
                    </button>
                    <button class="theme-toggle" id="themeToggle" title="থিম পরিবর্তন">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
            <div class="tabs-container">
                <div class="tabs">
                    <button class="tab-btn active" data-target="createPage">
                        <i class="fas fa-pen"></i>
                        নতুন নোট
                    </button>
                    <button class="tab-btn" data-target="notesPage">
                        <i class="fas fa-layer-group"></i>
                        সব নোট
                    </button>
                    <button class="tab-btn" data-target="readPage">
                        <i class="fas fa-book-reader"></i>
                        পড়ুন
                    </button>
                </div>
            </div>
        </header>

        <main class="workspace">
            <section class="hero-panel">
                <h1>নতুনভাবে লিখুন, সাজান এবং পড়ুন</h1>
                <p>পরিষ্কার লেআউট, সুন্দর বাংলা টাইপোগ্রাফি এবং দ্রুত নোট ম্যানেজমেন্ট।</p>
            </section>

            <div class="content-area">
        
        <div class="page active" id="createPage">
            <div class="note-creator">
                <input type="text" class="note-title-input" id="noteTitle" placeholder="নোটের শিরোনাম লিখুন...">
                
                <div class="image-preview-container" id="imagePreviewContainer"></div>
                
                <div class="editor-toolbar">
                    <button class="tool-btn" onclick="formatText('bold')" title="বোল্ড">
                        <i class="fas fa-bold"></i>
                    </button>
                    <button class="tool-btn" onclick="formatText('italic')" title="ইটালিক">
                        <i class="fas fa-italic"></i>
                    </button>
                    <button class="tool-btn" onclick="formatText('underline')" title="আন্ডারলাইন">
                        <i class="fas fa-underline"></i>
                    </button>
                    <button class="tool-btn" onclick="insertBulletList()" title="বুলেট লিস্ট">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button class="tool-btn" onclick="insertNumberedList()" title="নাম্বার লিস্ট">
                        <i class="fas fa-list-ol"></i>
                    </button>
                    
                    <label for="imageUpload" class="tool-btn" id="imageUploadLabel" title="ছবি যোগ করুন">
                        <i class="fas fa-image"></i>
                    </label>
                    <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;">
                    
                    <div class="save-btn-container">
                        <button class="export-btn" id="importBtn" title="নোট ইমপোর্ট করুন">
                            <i class="fas fa-upload"></i>
                            ইমপোর্ট
                        </button>
                        <input type="file" id="importFile" accept=".json,.html,.txt" style="display: none;">
                        <button class="save-button" id="saveNoteBtn">
                            <div class="button-outline"></div>
                            <div class="button-state state--default">
                                <div class="icon">
                                    <svg
                                        width="1em"
                                        height="1em"
                                        viewBox="0 0 24 24"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <g style="filter: url(#shadow)">
                                            <path
                                                d="M14.2199 21.63C13.0399 21.63 11.3699 20.8 10.0499 16.83L9.32988 14.67L7.16988 13.95C3.20988 12.63 2.37988 10.96 2.37988 9.78001C2.37988 8.61001 3.20988 6.93001 7.16988 5.60001L15.6599 2.77001C17.7799 2.06001 19.5499 2.27001 20.6399 3.35001C21.7299 4.43001 21.9399 6.21001 21.2299 8.33001L18.3999 16.82C17.0699 20.8 15.3999 21.63 14.2199 21.63ZM7.63988 7.03001C4.85988 7.96001 3.86988 9.06001 3.86988 9.78001C3.86988 10.5 4.85988 11.6 7.63988 12.52L10.1599 13.36C10.3799 13.43 10.5599 13.61 10.6299 13.83L11.4699 16.35C12.3899 19.13 13.4999 20.12 14.2199 20.12C14.9399 20.12 16.0399 19.13 16.9699 16.35L19.7999 7.86001C20.3099 6.32001 20.2199 5.06001 19.5699 4.41001C18.9199 3.76001 17.6599 3.68001 16.1299 4.19001L7.63988 7.03001Z"
                                                fill="currentColor"
                                            ></path>
                                            <path
                                                d="M10.11 14.4C9.92005 14.4 9.73005 14.33 9.58005 14.18C9.29005 13.89 9.29005 13.41 9.58005 13.12L13.16 9.53C13.45 9.24 13.93 9.24 14.22 9.53C14.51 9.82 14.51 10.3 14.22 10.59L10.64 14.18C10.5 14.33 10.3 14.4 10.11 14.4Z"
                                                fill="currentColor"
                                            ></path>
                                        </g>
                                        <defs>
                                            <filter id="shadow">
                                                <fedropshadow
                                                    dx="0"
                                                    dy="1"
                                                    stdDeviation="0.6"
                                                    flood-opacity="0.5"
                                                ></fedropshadow>
                                            </filter>
                                        </defs>
                                    </svg>
                                </div>
                                <p class="save-text">
                                    <span style="--i:0">সে</span>
                                    <span style="--i:1">ভ</span>
                                    <span style="--i:2"></span>
                                </p>
                            </div>
                            <div class="button-state state--sent">
                                <div class="icon">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        height="1em"
                                        width="1em"
                                        stroke-width="0.5px"
                                        stroke="black"
                                    >
                                        <g style="filter: url(#shadow)">
                                            <path
                                                fill="currentColor"
                                                d="M12 22.75C6.07 22.75 1.25 17.93 1.25 12C1.25 6.07 6.07 1.25 12 1.25C17.93 1.25 22.75 6.07 22.75 12C22.75 17.93 17.93 22.75 12 22.75ZM12 2.75C6.9 2.75 2.75 6.9 2.75 12C2.75 17.1 6.9 21.25 12 21.25C17.1 21.25 21.25 17.1 21.25 12C21.25 6.9 17.1 2.75 12 2.75Z"
                                            ></path>
                                            <path
                                                fill="currentColor"
                                                d="M10.5795 15.5801C10.3795 15.5801 10.1895 15.5001 10.0495 15.3601L7.21945 12.5301C6.92945 12.2401 6.92945 11.7601 7.21945 11.4701C7.50945 11.1801 7.98945 11.1801 8.27945 11.4701L10.5795 13.7701L15.7195 8.6301C16.0095 8.3401 16.4895 8.3401 16.7795 8.6301C17.0695 8.9201 17.0695 9.4001 16.7795 9.6901L11.1095 15.3601C10.9695 15.5001 10.7795 15.5801 10.5795 15.5801Z"
                                            ></path>
                                        </g>
                                    </svg>
                                </div>
                               <p class="update-text"> 
                                    <span style="--i:5">সে</span> 
                                    <span style="--i:6">ভ</span> 
                                    <span style="--i:7"></span> 
                                </p>
                            </div>
                        </button>
                    </div>
                </div>
                
                <div class="note-editor" id="noteEditor" contenteditable="true" placeholder="আপনার নোট এখানে লিখুন..."></div>
            </div>
        </div>
        
        <div class="page" id="notesPage">
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="নোট খুঁজুন...">
            </div>
            
            <div class="notes-grid" id="notesContainer"></div>
            
            <div class="empty-state" id="emptyNotesState" style="display: none;">
                <i class="fas fa-sticky-note"></i>
                <h3>কোন নোট নেই</h3>
                <p>এখনও কোনো নোট তৈরি করা হয়নি। নতুন নোট তৈরি করতে "নতুন নোট" ট্যাবে ক্লিক করুন।</p>
            </div>
        </div>
        
        <div class="page" id="readPage">
            <div class="note-reader" id="noteReader">
                <div class="empty-state" id="emptyReaderState">
                    <i class="fas fa-book-open"></i>
                    <h3>নোট নির্বাচন করুন</h3>
                    <p>নোট পড়তে "সব নোট" ট্যাব থেকে একটি নোট সিলেক্ট করুন।</p>
                </div>
                
                <div id="noteContent" style="display: none;">
                    <h1 class="read-note-title" id="readNoteTitle"></h1>
                    
                    <div class="read-note-meta">
                        <span id="readNoteDate"></span>
                        <span id="readNoteTime"></span>
                    </div>
                    
                    <div class="read-note-content" id="readNoteContent"></div>
                    
                    <div class="reader-actions">
                        <button class="action-btn btn-export" id="exportNoteBtn">
                            <i class="fas fa-download"></i>
                            এক্সপোর্ট
                        </button>
                        <button class="action-btn btn-edit" id="editNoteBtn">
                            <i class="fas fa-edit"></i>
                            এডিট করুন
                        </button>
                        <button class="action-btn btn-delete" id="deleteNoteBtn">
                            <i class="fas fa-trash"></i>
                            ডিলিট করুন
                        </button>
                        <button class="action-btn btn-back" id="backToNotesBtn">
                            <i class="fas fa-arrow-left"></i>
                            নোটসে ফিরে যান
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
            </div>
        </main>
    </div>

    <div class="modal" id="imageModal">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <img class="modal-img" id="modalImage" src="" alt="বড় ছবি">
    </div>
    
    <script>
        // à¦¥à¦¿à¦® à¦Ÿà¦—à¦²
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            body.setAttribute('data-theme', newTheme);
            
            const icon = themeToggle.querySelector('i');
            icon.className = newTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
            
            localStorage.setItem('notePadTheme', newTheme);
        });
        
        const savedTheme = localStorage.getItem('notePadTheme') || 'light';
        body.setAttribute('data-theme', savedTheme);
        themeToggle.querySelector('i').className = savedTheme === 'light' ? 'fas fa-moon' : 'fas fa-sun';
        
        // à¦Ÿà§à¦¯à¦¾à¦¬ à¦¨à§‡à¦­à¦¿à¦—à§‡à¦¶à¦¨
        const tabBtns = document.querySelectorAll('.tab-btn');
        const pages = document.querySelectorAll('.page');
        
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                tabBtns.forEach(t => t.classList.remove('active'));
                btn.classList.add('active');
                
                const targetPage = btn.getAttribute('data-target');
                pages.forEach(page => {
                    page.classList.remove('active');
                    if (page.id === targetPage) {
                        page.classList.add('active');
                    }
                });
                
                if (targetPage === 'notesPage') {
                    renderNotes();
                }
            });
        });
        
        // à¦¨à§‹à¦Ÿ à¦à¦¡à¦¿à¦Ÿà¦° à¦«à¦°à¦®à§à¦¯à¦¾à¦Ÿà¦¿à¦‚
        function formatText(command) {
            document.execCommand(command, false, null);
            document.getElementById('noteEditor').focus();
        }
        
        function insertBulletList() {
            document.execCommand('insertUnorderedList', false, null);
            document.getElementById('noteEditor').focus();
        }
        
        function insertNumberedList() {
            document.execCommand('insertOrderedList', false, null);
            document.getElementById('noteEditor').focus();
        }

        // à¦›à¦¬à¦¿ à¦•à¦®à§à¦ªà§à¦°à§‡à¦¶à¦¨ à¦«à¦¾à¦‚à¦¶à¦¨
        function compressImage(file, maxWidth = 800, quality = 0.7) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                        resolve(compressedDataUrl);
                    };
                };
            });
        }

        // à¦‡à¦®à§‡à¦œ à¦†à¦ªà¦²à§‹à¦¡ à¦¹à§à¦¯à¦¾à¦¨à§à¦¡à¦²à¦¿à¦‚ (à¦•à¦®à§à¦ªà§à¦°à§‡à¦¶à¦¨ à¦¸à¦¹)
        const imageUpload = document.getElementById('imageUpload');
        const imagePreviewContainer = document.getElementById('imagePreviewContainer');
        
        imageUpload.addEventListener('change', async function(e) {
            const files = e.target.files;
            
            if (files.length > 0) {
                imagePreviewContainer.classList.add('show');
                
                for (let file of files) {
                    try {
                        const compressedImage = await compressImage(file);
                        
                        const thumb = document.createElement('img');
                        thumb.className = 'preview-thumb';
                        thumb.src = compressedImage;
                        thumb.onclick = () => openModal(compressedImage);
                        
                        imagePreviewContainer.appendChild(thumb);
                        
                        const imgElement = `<img src="${compressedImage}" style="max-width: 100%; border-radius: 10px; margin: 10px 0;" alt="à¦¨à§‹à¦Ÿ à¦›à¦¬à¦¿">`;
                        document.getElementById('noteEditor').focus();
                        document.execCommand('insertHTML', false, imgElement);
                    } catch (error) {
                        console.error('Image compression error:', error);
                    }
                }
            }
        });
        
        // à¦®à§‹à¦¡à¦¾à¦² à¦«à¦¾à¦‚à¦¶à¦¨
        function openModal(imgSrc) {
            document.getElementById('modalImage').src = imgSrc;
            document.getElementById('imageModal').classList.add('show');
        }
        
        function closeModal() {
            document.getElementById('imageModal').classList.remove('show');
        }
        
        // à¦¨à§‹à¦Ÿ à¦®à§à¦¯à¦¾à¦¨à§‡à¦œà¦®à§‡à¦¨à§à¦Ÿ
        let notes = [];
        try {
            const savedNotes = localStorage.getItem('notePadNotes');
            if (savedNotes) {
                notes = JSON.parse(savedNotes);
            }
        } catch (e) {
            console.error('à¦¨à§‹à¦Ÿ à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾:', e);
            notes = [];
        }
        
        let currentNoteIndex = null;
        
        // à¦¸à§‡à¦­ à¦¬à¦¾à¦Ÿà¦¨ à¦à¦¨à¦¿à¦®à§‡à¦¶à¦¨ à¦¹à§à¦¯à¦¾à¦¨à§à¦¡à¦²à¦¿à¦‚
        const saveButton = document.getElementById('saveNoteBtn');
        let isSaving = false;
        
        // à¦¸à§‡à¦­ à¦¬à¦¾à¦Ÿà¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿ
        saveButton.addEventListener('click', function(e) {
            e.preventDefault();
            if (isSaving) return;
            
            const title = document.getElementById('noteTitle').value.trim();
            const content = document.getElementById('noteEditor').innerHTML.trim();
            
            if (!title) {
                alert('à¦¦à¦¯à¦¼à¦¾ à¦•à¦°à§‡ à¦¨à§‹à¦Ÿà§‡à¦° à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦® à¦¦à¦¿à¦¨');
                document.getElementById('noteTitle').focus();
                return;
            }
            
            if (!content || content === '<br>' || content === '<div><br></div>') {
                alert('à¦¦à¦¯à¦¼à¦¾ à¦•à¦°à§‡ à¦¨à§‹à¦Ÿà§‡à¦° à¦¬à¦¿à¦·à¦¯à¦¼à¦¬à¦¸à§à¦¤à§ à¦²à¦¿à¦–à§à¦¨');
                document.getElementById('noteEditor').focus();
                return;
            }
            
            isSaving = true;
            
            this.focus();
            
            setTimeout(() => {
                let success = false;
                
                if (currentNoteIndex !== null) {
                    success = updateNote();
                } else {
                    success = saveNote();
                }
                
                if (success) {
                    setTimeout(() => {
                        this.blur();
                        isSaving = false;
                    }, 1500);
                } else {
                    this.blur();
                    isSaving = false;
                }
            }, 800);
        });
        
        // à¦¨à§‹à¦Ÿ à¦¸à§‡à¦­
        function saveNote() {
            const title = document.getElementById('noteTitle').value.trim();
            const content = document.getElementById('noteEditor').innerHTML.trim();
            
            const now = new Date();
            const noteDate = now.toLocaleDateString('bn-BD', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            const noteTime = now.toLocaleTimeString('bn-BD', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });
            
            const noteDateTime = now.toISOString();
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            const images = tempDiv.querySelectorAll('img');
            const imageSrc = images.length > 0 ? images[0].src : '';
            
            const italicElements = tempDiv.querySelectorAll('i, em');
            let italicNotes = [];
            
            italicElements.forEach(el => {
                const text = el.textContent.trim();
                if (text !== '' && text.length > 0) {
                    italicNotes.push(text);
                }
            });
            
            const note = {
                id: Date.now(),
                title: title,
                content: content,
                date: noteDate,
                time: noteTime,
                dateTime: noteDateTime,
                imageSrc: imageSrc,
                italicNotes: italicNotes
            };
            
            notes.unshift(note);
            
            try {
                localStorage.setItem('notePadNotes', JSON.stringify(notes));
                console.log('à¦¨à§‹à¦Ÿ à¦¸à§‡à¦­ à¦¹à§Ÿà§‡à¦›à§‡:', note);
            } catch (e) {
                console.error('à¦²à§‹à¦•à¦¾à¦² à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œà§‡ à¦¸à§‡à¦­ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾:', e);
                alert('à¦¨à§‹à¦Ÿ à¦¸à§‡à¦­ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦šà§à¦›à§‡à¥¤ à¦¬à§à¦°à¦¾à¦‰à¦œà¦¾à¦°à§‡à¦° à¦¸à§‡à¦Ÿà¦¿à¦‚à¦¸ à¦šà§‡à¦• à¦•à¦°à§à¦¨à¥¤');
                return false;
            }
            
            resetForm();
            
            setTimeout(() => {
                document.querySelector('[data-target="notesPage"]').click();
            }, 500);
            
            return true;
        }
        
        function resetForm() {
            document.getElementById('noteTitle').value = '';
            document.getElementById('noteEditor').innerHTML = '';
            imagePreviewContainer.innerHTML = '';
            imagePreviewContainer.classList.remove('show');
            document.getElementById('imageUpload').value = '';
            currentNoteIndex = null;
            
            const saveText = document.querySelector('.save-text');
            const updateText = document.querySelector('.update-text');
            
            saveText.innerHTML = `
                <span style="--i:0">à¦¸</span>
                <span style="--i:1">à§‡</span>
                <span style="--i:2">à¦­</span>
            `;
            
            updateText.innerHTML = `
                <span style="--i:5">à¦¸</span>
                <span style="--i:6">à§‡</span>
                <span style="--i:7">à¦­</span>
            `;
        }
        
        // à¦¨à§‹à¦Ÿ à¦°à§‡à¦¨à§à¦¡à¦¾à¦°
        function renderNotes(filter = '') {
            const notesContainer = document.getElementById('notesContainer');
            const emptyState = document.getElementById('emptyNotesState');
            
            if (!notesContainer) {
                console.error('notesContainer à¦–à§à¦à¦œà§‡ à¦ªà¦¾à¦“à§Ÿà¦¾ à¦¯à¦¾à¦šà§à¦›à§‡ à¦¨à¦¾!');
                return;
            }
            
            const filteredNotes = notes.filter(note => {
                if (!note || !note.title) return false;
                
                if (!filter) return true;
                
                const searchTerm = filter.toLowerCase();
                const title = (note.title || '').toLowerCase();
                const content = (note.content || '').replace(/<[^>]*>/g, '').toLowerCase();
                
                return title.includes(searchTerm) || content.includes(searchTerm);
            });
            
            if (filteredNotes.length === 0) {
                notesContainer.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            notesContainer.innerHTML = '';
            
            filteredNotes.forEach((note, index) => {
                const originalIndex = notes.findIndex(n => n.id === note.id);
                const displayIndex = originalIndex !== -1 ? originalIndex : index;
                
                const card = document.createElement('div');
                card.className = 'note-card';
                card.setAttribute('data-index', displayIndex);
                
                let backgroundImage = note.imageSrc || '';
                
                let backgroundStyle = '';
                if (backgroundImage) {
                    backgroundStyle = `background-image: url('${backgroundImage}');`;
                } else {
                    const gradients = [
                        'linear-gradient(135deg, #4361ee, #3a0ca3)',
                        'linear-gradient(135deg, #f72585, #b5179e)',
                        'linear-gradient(135deg, #4cc9f0, #4895ef)',
                        'linear-gradient(135deg, #f8961e, #f3722c)',
                        'linear-gradient(135deg, #43e97b, #38f9d7)'
                    ];
                    const randomGradient = gradients[note.id % gradients.length];
                    backgroundStyle = `background: ${randomGradient};`;
                }
                
                card.innerHTML = `
                    ${backgroundImage ? `<img class="card-background" src="${backgroundImage}" alt="à¦¨à§‹à¦Ÿ à¦›à¦¬à¦¿">` : ''}
                    <div class="card-overlay"></div>
                    <div class="card-content">
                        <div class="card-top">
                            <h3 class="card-title">${note.title}</h3>
                            <div class="card-date-time">
                                <div class="card-date">${note.date}</div>
                                <div class="card-time">${note.time}</div>
                            </div>
                        </div>
                        <div class="card-actions">
                            <div class="share-button-container">
                                <button class="card-action-btn share-btn" onclick="event.stopPropagation(); shareNote(${displayIndex})" title="à¦¶à§‡à§Ÿà¦¾à¦° à¦•à¦°à§à¦¨">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                                <div class="share-tooltip">
                                    <div class="social-icons">
                                        <a href="#" class="social-icon facebook" onclick="event.stopPropagation(); shareToFacebook(${displayIndex})">
                                            <i class="fab fa-facebook-f"></i>
                                        </a>
                                        <a href="#" class="social-icon email" onclick="event.stopPropagation(); shareToEmail(${displayIndex})">
                                            <i class="fas fa-envelope"></i>
                                        </a>
                                        <a href="#" class="social-icon linkedin" onclick="event.stopPropagation(); shareToLinkedIn(${displayIndex})">
                                            <i class="fab fa-linkedin-in"></i>
                                        </a>
                                        <a href="#" class="social-icon whatsapp" onclick="event.stopPropagation(); shareToWhatsApp(${displayIndex})">
                                            <i class="fab fa-whatsapp"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <button class="export-icon-btn" onclick="event.stopPropagation(); exportSingleNote(${displayIndex})" title="à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ à¦•à¦°à§à¦¨">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="card-action-btn" onclick="event.stopPropagation(); editNote(${displayIndex})" title="à¦à¦¡à¦¿à¦Ÿ à¦•à¦°à§à¦¨">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="card-action-btn" onclick="event.stopPropagation(); deleteNote(${displayIndex})" title="à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦•à¦°à§à¦¨">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                if (!backgroundImage) {
                    card.style = backgroundStyle;
                }
                
                card.addEventListener('click', () => viewNote(displayIndex));
                
                notesContainer.appendChild(card);
            });
        }
        
        // à¦¸à¦¾à¦°à§à¦š à¦«à¦¾à¦‚à¦¶à¦¨
        document.getElementById('searchInput').addEventListener('input', function() {
            renderNotes(this.value);
        });
        
        // à¦¨à§‹à¦Ÿ à¦¦à§‡à¦–à¦¾
        function viewNote(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            currentNoteIndex = index;
            
            document.getElementById('readNoteTitle').textContent = note.title;
            document.getElementById('readNoteDate').textContent = note.date;
            document.getElementById('readNoteTime').textContent = note.time;
            
            document.getElementById('readNoteContent').innerHTML = note.content;
            
            document.getElementById('emptyReaderState').style.display = 'none';
            document.getElementById('noteContent').style.display = 'block';
            
            document.querySelector('[data-target="readPage"]').click();
        }
        
        // à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ à¦«à¦¾à¦‚à¦¶à¦¨à¦¸à¦®à§‚à¦¹

        // à§§. à¦à¦•à¦Ÿà¦¿ à¦¨à§‹à¦Ÿ à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ (HTML à¦«à¦°à¦®à§‡à¦Ÿà§‡)
        function exportSingleNote(index) {
            if (index < 0 || index >= notes.length) {
                alert('à¦¨à§‹à¦Ÿ à¦–à§à¦à¦œà§‡ à¦ªà¦¾à¦“à§Ÿà¦¾ à¦¯à¦¾à§Ÿà¦¨à¦¿!');
                return;
            }
            
            const note = notes[index];
            
            // HTML à¦•à¦¨à§à¦Ÿà§‡à¦¨à§à¦Ÿ à¦¤à§ˆà¦°à¦¿
            const htmlContent = `
<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${note.title} - à¦¨à§‹à¦Ÿ à¦ªà§‡à¦¡</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./app-redesign.css">
</head>
<body>
    <div class="note-container">
        <h1 class="note-title">${note.title}</h1>
        
        <div class="note-meta">
            <span>à¦¤à¦¾à¦°à¦¿à¦–: ${note.date}</span>
            <span>à¦¸à¦®à¦¯à¦¼: ${note.time}</span>
        </div>
        
        <div class="note-content">
            ${note.content}
        </div>
        
        <div class="footer">
            <p>à¦¨à§‹à¦Ÿ à¦ªà§‡à¦¡ à¦¥à§‡à¦•à§‡ à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡</p>
            <p>${new Date().toLocaleDateString('bn-BD')} ${new Date().toLocaleTimeString('bn-BD')}</p>
        </div>
    </div>
</body>
</html>`;
            
            // à¦«à¦¾à¦‡à¦² à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡
            downloadFile(htmlContent, `${note.title}.html`, 'text/html');
        }

        // à§¨. à¦¸à¦¬ à¦¨à§‹à¦Ÿ à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ (JSON à¦«à¦°à¦®à§‡à¦Ÿà§‡ - à¦¬à§à¦¯à¦¾à¦•à¦†à¦ª)
        function exportAllNotes() {
            if (notes.length === 0) {
                alert('à¦•à§‹à¦¨ à¦¨à§‹à¦Ÿ à¦¨à§‡à¦‡ à¦à¦•à§à¦¸à¦ªà§‹à¦°à§à¦Ÿ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯!');
                return;
            }
            
            const backupData = {
                appName: 'à¦¨à§‹à¦Ÿ à¦ªà§‡à¦¡',
                exportDate: new Date().toISOString(),
                totalNotes: notes.length,
                notes: notes
            };
            
            const jsonContent = JSON.stringify(backupData, null, 2);
            const date = new Date().toISOString().split('T')[0];
            downloadFile(jsonContent, `notepad-backup-${date}.json`, 'application/json');
        }

        // à§©. à¦‡à¦®à¦ªà§‹à¦°à§à¦Ÿ à¦«à¦¾à¦‚à¦¶à¦¨ (JSON à¦¬à§à¦¯à¦¾à¦•à¦†à¦ª à¦¥à§‡à¦•à§‡)
        function importNotes(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (!importedData.notes || !Array.isArray(importedData.notes)) {
                        alert('à¦­à§à¦² à¦«à¦°à¦®à§‡à¦Ÿà§‡à¦° à¦«à¦¾à¦‡à¦²!');
                        return;
                    }
                    
                    if (confirm(`à¦†à¦ªà¦¨à¦¿ ${importedData.notes.length}à¦Ÿà¦¿ à¦¨à§‹à¦Ÿ à¦‡à¦®à¦ªà§‹à¦°à§à¦Ÿ à¦•à¦°à¦¤à§‡ à¦šà¦²à§‡à¦›à§‡à¦¨à¥¤ à¦†à¦ªà¦¨à¦¿ à¦•à¦¿ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤?`)) {
                        // à¦ªà§à¦°à§‹à¦¨à§‹ à¦¨à§‹à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¨à¦¤à§à¦¨ à¦¨à§‹à¦Ÿ à¦¯à§‹à¦— à¦•à¦°à§à¦¨
                        notes = [...importedData.notes, ...notes];
                        
                        // à¦²à§‹à¦•à¦¾à¦² à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œà§‡ à¦¸à§‡à¦­ à¦•à¦°à§à¦¨
                        localStorage.setItem('notePadNotes', JSON.stringify(notes));
                        
                        // à¦°à¦¿à¦«à§à¦°à§‡à¦¶ à¦•à¦°à§à¦¨
                        renderNotes();
                        alert(`${importedData.notes.length}à¦Ÿà¦¿ à¦¨à§‹à¦Ÿ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦‡à¦®à¦ªà§‹à¦°à§à¦Ÿ à¦¹à§Ÿà§‡à¦›à§‡!`);
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    alert('à¦«à¦¾à¦‡à¦² à¦ªà§à¦¯à¦¾à¦°à§à¦¸ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦šà§à¦›à§‡!');
                }
                
                // à¦«à¦¾à¦‡à¦² à¦‡à¦¨à¦ªà§à¦Ÿ à¦°à¦¿à¦¸à§‡à¦Ÿ
                event.target.value = '';
            };
            
            reader.readAsText(file);
        }

        // à§ª. à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦«à¦¾à¦‚à¦¶à¦¨ - à¦«à¦¾à¦‡à¦² à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡
        function downloadFile(content, fileName, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // à¦‡à¦­à§‡à¦¨à§à¦Ÿ à¦²à¦¿à¦¸à§à¦Ÿà§‡à¦¨à¦¾à¦° à¦¯à§‹à¦— à¦•à¦°à§à¦¨
        document.getElementById('exportAllBtn').addEventListener('click', exportAllNotes);
        document.getElementById('exportNoteBtn').addEventListener('click', () => {
            if (currentNoteIndex !== null) {
                exportSingleNote(currentNoteIndex);
            } else {
                alert('à¦ªà§à¦°à¦¥à¦®à§‡ à¦à¦•à¦Ÿà¦¿ à¦¨à§‹à¦Ÿ à¦¸à¦¿à¦²à§‡à¦•à§à¦Ÿ à¦•à¦°à§à¦¨!');
            }
        });
        
        document.getElementById('importBtn').addEventListener('click', () => {
            document.getElementById('importFile').click();
        });
        
        document.getElementById('importFile').addEventListener('change', importNotes);

        // à¦¶à§‡à§Ÿà¦¾à¦° à¦«à¦¾à¦‚à¦¶à¦¨
        function shareNote(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            const text = `à¦¨à§‹à¦Ÿ: ${note.title}\n\n${note.content.replace(/<[^>]*>/g, '').substring(0, 100)}...`;
            
            if (navigator.share) {
                navigator.share({
                    title: note.title,
                    text: text,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(text);
                alert('à¦¨à§‹à¦Ÿ à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡!');
            }
        }
        
        function shareToFacebook(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(`à¦¨à§‹à¦Ÿ: ${note.title}`);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank');
        }
        
        function shareToEmail(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            const emailSubject = `à¦¨à§‹à¦Ÿ: ${note.title}`;
            const emailBody = `
à¦¨à§‹à¦Ÿ à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦®: ${note.title}

à¦¤à¦¾à¦°à¦¿à¦–: ${note.date}
à¦¸à¦®à¦¯à¦¼: ${note.time}

à¦¬à¦¿à¦·à¦¯à¦¼à¦¬à¦¸à§à¦¤à§:
${note.content.replace(/<[^>]*>/g, '').substring(0, 500)}...

---
à¦¨à§‹à¦Ÿ à¦ªà§‡à¦¡ à¦¥à§‡à¦•à§‡ à¦ªà§à¦°à§‡à¦°à¦¿à¦¤
            `.trim();
            
            window.open(`mailto:?subject=${encodeURIComponent(emailSubject)}&body=${encodeURIComponent(emailBody)}`, '_blank');
        }
        
        function shareToLinkedIn(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
        }
        
        function shareToWhatsApp(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            const text = encodeURIComponent(`à¦¨à§‹à¦Ÿ: ${note.title}\n\n${note.content.replace(/<[^>]*>/g, '').substring(0, 100)}...`);
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }
        
        // à¦¨à§‹à¦Ÿ à¦à¦¡à¦¿à¦Ÿ
        function editNote(index) {
            if (index < 0 || index >= notes.length) return;
            
            const note = notes[index];
            currentNoteIndex = index;
            
            document.getElementById('noteTitle').value = note.title;
            document.getElementById('noteEditor').innerHTML = note.content;
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = note.content;
            const images = tempDiv.querySelectorAll('img');
            
            if (images.length > 0) {
                imagePreviewContainer.classList.add('show');
                imagePreviewContainer.innerHTML = '';
                images.forEach(img => {
                    if (img.src) {
                        const thumb = document.createElement('img');
                        thumb.className = 'preview-thumb';
                        thumb.src = img.src;
                        thumb.onclick = () => openModal(img.src);
                        imagePreviewContainer.appendChild(thumb);
                    }
                });
            }
            
            const saveText = document.querySelector('.save-text');
            const updateText = document.querySelector('.update-text');
            
            saveText.innerHTML = `
                <span style="--i:0">à¦†</span>
                <span style="--i:1">à¦ª</span>
                <span style="--i:2">à¦¡</span>
                <span style="--i:3">à§‡</span>
                <span style="--i:4">à¦Ÿ</span>
            `;
            
            updateText.innerHTML = `
                <span style="--i:5">à¦†</span>
                <span style="--i:6">à¦ª</span>
                <span style="--i:7">à¦¡</span>
                <span style="--i:8">à§‡</span>
                <span style="--i:9">à¦Ÿ</span>
            `;
            
            document.querySelector('[data-target="createPage"]').click();
        }
        
        // à¦¨à§‹à¦Ÿ à¦†à¦ªà¦¡à§‡à¦Ÿ
        function updateNote() {
            if (currentNoteIndex === null || currentNoteIndex < 0 || currentNoteIndex >= notes.length) return false;
            
            const title = document.getElementById('noteTitle').value.trim();
            const content = document.getElementById('noteEditor').innerHTML.trim();
            
            if (!title || !content || content === '<br>' || content === '<div><br></div>') {
                alert('à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦® à¦à¦¬à¦‚ à¦¬à¦¿à¦·à¦¯à¦¼à¦¬à¦¸à§à¦¤à§ à¦ªà§à¦°à¦¯à¦¼à§‹à¦œà¦¨');
                return false;
            }
            
            const now = new Date();
            const noteDate = now.toLocaleDateString('bn-BD', {
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });
            
            const noteTime = now.toLocaleTimeString('bn-BD', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            const images = tempDiv.querySelectorAll('img');
            const imageSrc = images.length > 0 ? images[0].src : '';
            
            const italicElements = tempDiv.querySelectorAll('i, em');
            let italicNotes = [];
            
            italicElements.forEach(el => {
                const text = el.textContent.trim();
                if (text !== '' && text.length > 0) {
                    italicNotes.push(text);
                }
            });
            
            notes[currentNoteIndex] = {
                ...notes[currentNoteIndex],
                title: title,
                content: content,
                date: noteDate,
                time: noteTime,
                dateTime: now.toISOString(),
                imageSrc: imageSrc,
                italicNotes: italicNotes
            };
            
            try {
                localStorage.setItem('notePadNotes', JSON.stringify(notes));
            } catch (e) {
                console.error('à¦²à§‹à¦•à¦¾à¦² à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾:', e);
                alert('à¦¨à§‹à¦Ÿ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦šà§à¦›à§‡à¥¤');
                return false;
            }
            
            resetForm();
            
            setTimeout(() => {
                document.querySelector('[data-target="notesPage"]').click();
            }, 500);
            
            currentNoteIndex = null;
            return true;
        }
        
        // à¦¨à§‹à¦Ÿ à¦¡à¦¿à¦²à¦¿à¦Ÿ
        function deleteNote(index) {
            if (index < 0 || index >= notes.length) return;
            
            if (confirm('à¦†à¦ªà¦¨à¦¿ à¦•à¦¿ à¦à¦‡ à¦¨à§‹à¦Ÿà¦Ÿà¦¿ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦•à¦°à¦¤à§‡ à¦šà¦¾à¦¨?')) {
                notes.splice(index, 1);
                try {
                    localStorage.setItem('notePadNotes', JSON.stringify(notes));
                } catch (e) {
                    console.error('à¦²à§‹à¦•à¦¾à¦² à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾:', e);
                }
                renderNotes();
                
                if (currentNoteIndex === index) {
                    document.getElementById('emptyReaderState').style.display = 'block';
                    document.getElementById('noteContent').style.display = 'none';
                    currentNoteIndex = null;
                }
            }
        }
        
        // à¦°à¦¿à¦¡à¦¾à¦° à¦ªà§‡à¦œ à¦¬à¦¾à¦Ÿà¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿ
        document.getElementById('editNoteBtn').addEventListener('click', () => {
            if (currentNoteIndex !== null) {
                editNote(currentNoteIndex);
            }
        });
        
        document.getElementById('deleteNoteBtn').addEventListener('click', () => {
            if (currentNoteIndex !== null) {
                deleteNote(currentNoteIndex);
            }
        });
        
        document.getElementById('backToNotesBtn').addEventListener('click', () => {
            document.querySelector('[data-target="notesPage"]').click();
        });
        
        // à¦…à§à¦¯à¦¾à¦ª à¦‡à¦¨à¦¿à¦¶à¦¿à¦¯à¦¼à¦¾à¦²à¦¾à¦‡à¦œà§‡à¦¶à¦¨
        function initApp() {
            renderNotes();
            
            if (notes.length > 0) {
                document.getElementById('emptyReaderState').style.display = 'none';
            }
        }
        
        // à¦…à§à¦¯à¦¾à¦ª à¦¶à§à¦°à§
        initApp();
        
        // à¦Ÿà§à¦°à¦¿à¦ªà¦² à¦•à§à¦²à¦¿à¦• à¦¥à¦¿à¦® à¦Ÿà¦—à¦²
        let clickCount = 0;
        document.addEventListener('click', (e) => {
            if (e.target.closest('.theme-toggle')) return;
            
            clickCount++;
            setTimeout(() => {
                clickCount = 0;
            }, 500);
            
            if (clickCount === 3) {
                themeToggle.click();
            }
        });
        
        // à¦à¦¸à¦•à§‡à¦ª à¦•à¦¿ à¦ªà§à¦°à§‡à¦¸à§‡ à¦®à§‹à¦¡à¦¾à¦² à¦¬à¦¨à§à¦§
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
<!-- test -->


